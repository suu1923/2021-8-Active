<!DOCTYPE html>
<html lang="zh">
	<head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <meta name="viewport" content="width=device-width,target-densitydpi=high-dpi,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
	<title>留言页面</title>
	<link rel="stylesheet" type="text/css" href="/static/css/swiper.min.css">
	<style type="text/css">

body {
	background: url("/static/img/bg.png");
	background-repeat: no-repeat;
	font-family: "Roboto", sans-serif;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
    -ms-overflow-style: none; /* IE 10+ */

}
.content{
    width: 70%;
    position: absolute;
    top: 110px;
    left: 0;
    right: 0;
    margin: 0 auto;
    text-align: center;
}
.content textarea{
    display: block;
    border:0;
    border-radius:5px;
    background-color:rgba(241,241,241,.98);
    width: 96%;
    height: 200px;
    font-size: 14px;
    font-weight: 700;
    font-family: "Microsoft soft";
    padding: 5px;
    resize: none;
    overflow-y: hidden;
    overflow-x: hidden;

}

.content input{
    display: block;
    border:0;
    border-radius:5px;
    background-color:rgba(241,241,241,.98);
    width: 40%;
    height: 30px;
    font-size: 14px;
    font-weight: 700;
    font-family: "Microsoft soft";
    padding: 5px;
    resize: none;
    margin-bottom: 20px;
    overflow-y: hidden;
}


.bg{
    width: 100%;
    height: 99vh;
}

.bg1 {
    background: url("/static/img/p1.png");
    background-repeat: no-repeat;
    background-size: 100% 100%;
}
.sub{
    background: url("/static/img/btn.png");
    background-repeat: no-repeat;
    background-size: 100% 100%;
    border: none;
    width: 75%;
    height: 45px;
    margin-top: 30px;
}
.bg2{
    width: 100%;
    height: 100vh;
}
.bg2 .show{
    height: 75%;
    background: #fff;
    width: 80%;
    margin: 30px auto;
    border-radius: 13px;
    box-shadow: 8px 5px 14px 0px #888888;
}
.bg2 .show .top{
    width: 100%;
    height: 30px;
    padding-top: 10px;
}
        .bg2 .show .top .back{
            width: 10%;
            float: left;
            margin-left: 10px;
        }
.bg2 .show .top .titles{
    float: left;
    margin-left: 40px;
}
.content-img{
    width: 70%;
    border: 5px solid rgb(230,202,157);
    border-radius: 10px;
    margin: 20px auto;
}
.content-img img{
    width: 100%;
    height: 100%;
}
        .bg2 .btn-group{
            width: 80%;
            margin: 0 auto;
            z-index: 9999 !important;

        }
.bg2 .btn-group .group1,.group2 {
    width: 100%;
    height: 50px;
}
.bg2 .btn-group .group1 .btn1,.btn2{
    border: none;
    background: rgb(212,160,89);
    height: 50px;
    width: 49%;
    color: #fff;
    border-radius: 25px;
    font-size: 18px;
}
.bg2 .btn-group .group2 .btn3{
    border: none;
    background: rgb(212,160,89);
    height: 50px;
    width: 100%;
    color: #fff;
    border-radius: 25px;
    font-size: 18px;
    margin-top: 10px;
}

.swiper-pagination-bullet-active{
    background: rgb(212,160,89);
    z-index: 2 !important;
}
</style>
	</head>
	<body>
        <div class="swiper-container">
            <div class="swiper-wrapper">
                <div class="swiper-slide">

                    <div class="bg bg1">
                        <div class="content">
                            <input type="text" id="name" class="name"  placeholder="你的名字"
                                   maxlength="20">
                            <textarea style="" id="content" onblur="toTop()"
                                      placeholder="写下你想说的~"
                                      maxlength="200"></textarea>
                            <button class="sub"></button>
                        </div>
                    </div>

                </div>
                <div class="swiper-slide">
                    <div class="bg bg2">
                        <div class="show">
                            <div class="top">
                                <div class="back">
                                    <img src="/static/img/back.png" width="30px" height="30px" alt="">
                                </div>
                                <div class="titles">
                                    <img src="/static/img/title.png" height="30px" alt="">

                                </div>

                            </div>
                            <div class="content2">
                                <div class="swiper-container-content">
                                    <div class="swiper-wrapper">
                                        <div class="swiper-slide">
                                            <div class="content-img">
                                                <img src="/static/img/type1.png" alt="">
                                            </div>
                                        </div>
                                        <div class="swiper-slide">
                                            <div class="content-img">
                                                <img src="/static/img/type2.png" alt="">
                                            </div>
                                        </div>
                                        <div class="swiper-slide">
                                            <div class="content-img">
                                                <img src="/static/img/type3.png" alt="">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="swiper-pagination"
                                         style="position: relative;top: 0px;z-index: 2 !important;"></div>

                                </div>
                            </div>
                        </div>
                        <div class="btn-group">
                            <div class="group1">
                                <button class="btn1" typeid="1">直接发送</button>
                                <button class="btn2" typeid="2">直接打印</button>
                            </div>
                            <div class="group2">
                                <button class="btn3" typeid="3">发送并打印</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<script src="/static/js/jquery-2.1.1.min.js"></script>
<script src="/static/js/swiper.min.js"></script>
<script type="text/javascript">

    // 禁止全局滑动
    document.body.addEventListener('touchmove', function(e){
        e.preventDefault();
    }, { passive: false });

    var swiper = new Swiper('.swiper-container', {
        direction: 'vertical',
        autoplay:false,
        allowSlidePrev : false,
        allowSlideNext : false,
    });
    var swiper2 = new Swiper('.swiper-container-content',{
        pagination: {
            el: '.swiper-pagination',
        },
        autoplay:false,
    })

    // 回到最顶部
    function toTop(){
        scrollTo(0,0);
    }
	$(function(){


	    // 返回上一层
		$(".sub").click(function(){
            var name = $("#name").val();
            var content = $("#content").val();
            if (content == '' || name == ''){
                alert('请填写名字和内容不能为空哦');
                swiper.slideTo(0);
                return false;
            }
            if (content.length > 200){
                alert("留言内容太多了,请删除一些");
                swiper.slideTo(0);
                return false;
            }
            swiper.allowSlideNext = true;
            swiper.slideTo(1);
            swiper.allowSlideNext = false;
		})

        $(".back").click(function () {
            swiper.allowSlidePrev = true;
            swiper.slideTo(0);
            swiper.allowSlidePrev = false;
        })
        $('.btn1').click(function () {
            sendInfo(swiper2.activeIndex+1,1)
            return false
        })
        $('.btn2').click(function () {
            console.log(swiper2.activeIndex)
            sendInfo(swiper2.activeIndex+1,2)
            return false
        })
        $('.btn3').click(function () {
            console.log(swiper2.activeIndex)
            sendInfo(swiper2.activeIndex+1,3)
            return false
        })
        /**
         *
         * @param type 当前选择的样式
         * @param btn_type 当前按钮
         */
        function sendInfo(type,btn_type) {
            var name = $("#name").val();
            var content = $("#content").val();


            if (content == '' || name == ''){
                alert('请填写名字和内容不能为空哦');
                return false;
            }
            if (content.length > 200){
                alert("留言内容太多了,请删除一些");
                return false;
            }


            $.ajax({
               url: '/index.php/index/index/add',
               data: {
                   content : name+"&"+content+"&"+type+"&"+btn_type,
               },
               success: function(res) {
                   if (res == 1){
                       alert('留言成功');
                       window.location.reload();
                   }else if(res ==0){
                       alert('服务器异常');
                       window.location.reload();
                       return false;
                   }else{
                       alert(res)
                   }
               },
               error: function(res) {
                  alert('发送失败!');
               }
            })
        }

	})
	</script>
</body>
</html>